---
title: (è½¬è½½) lodashæºç  slice
date: 2021-12-15
categories:
- å‰ç«¯
tags:
- javascript
- lodash
---
##  _.slice(array, [start=0], [end=array.length])
> **ä»‹ç»:**   è£å‰ªæ•°ç»„`array`ï¼Œä»`start` ä½ç½®å¼€å§‹åˆ°`end`ç»“æŸï¼Œä½†ä¸åŒ…æ‹¬`end` æœ¬èº«çš„ä½ç½®ã€‚**è¿™ä¸ªæ–¹æ³•ç”¨äºä»£æ›¿Array#slice æ¥ç¡®ä¿æ•°ç»„æ­£ç¡®è¿”å›**  

**ä¸ºä»€ä¹ˆéœ€è¦æ›¿ä»£:**  
lodash çš„ slice ä¼šå°†æ•°ç»„å½“æˆå¯†é›†æ•°ç»„å¯¹å¾…ï¼ŒåŸç”Ÿçš„ slice ä¼šå°†æ•°ç»„å½“æˆç¨€ç–æ•°ç»„å¯¹å¾…ã€‚

#### å¯†é›†æ•°ç»„VSç¨€ç–æ•°ç»„

> ç¨€ç–æ•°ç»„å°±æ˜¯åŒ…å«ä»0å¼€å§‹çš„ä¸è¿ç»­ç´¢å¼•çš„æ•°ç»„ã€‚é€šå¸¸ï¼Œæ•°ç»„çš„lengthå±æ€§å€¼ä»£è¡¨æ•°ç»„ä¸­å…ƒç´ çš„ä¸ªæ•°ã€‚å¦‚æœæ•°ç»„æ˜¯ç¨€ç–çš„ï¼Œlengthå±æ€§å€¼å¤§äºå…ƒç´ çš„ä¸ªæ•°ã€‚

å¦‚æœæ•°ç»„æ˜¯ç¨€ç–çš„ï¼Œé‚£ä¹ˆè¿™ä¸ªæ•°ç»„ä¸­è‡³å°‘æœ‰ä¸€ä¸ªä»¥ä¸Šçš„ä½ç½®ä¸å­˜åœ¨å…ƒç´ ï¼ˆundefinedç®—å…ƒç´ ï¼‰ã€‚  
ğŸŒ°
```javascript
// sparse çš„ length ä¸º10ï¼Œä½†æ˜¯ sparse æ•°ç»„ä¸­æ²¡æœ‰å…ƒç´ ï¼Œæ˜¯ç¨€ç–æ•°ç»„
var sparse = new Array(10) 
// dense æ¯ä¸ªä½ç½®éƒ½æ˜¯æœ‰å…ƒç´ çš„ï¼Œè™½ç„¶æ¯ä¸ªå…ƒç´ éƒ½ä¸ºundefinedï¼Œä¸ºå¯†é›†æ•°ç»„
var dense = new Array(10).fill(undefined)
```
#### æºç æ€»è§ˆ
```javascript
function slice(array, start, end) {
  // array == null, é === ,åŒ…å«undefinedçš„åˆ¤æ–­ undefined == null true
  let length = array == null ? 0 : array.length
  // ä¸ä¼ å‚çš„æƒ…å†µ
  if (!length) {
    return []
  }
  // æ­¤éƒ¨åˆ†åˆ¤æ–­æ˜¯å¦å¸¦startæˆ–endçš„å‚
  // ä¸å¸¦çš„æ—¶å€™èµ‹äºˆåˆå§‹å€¼
  start = start == null ? 0 : start
  end = end === undefined ? length : end
  // start ä¸ºè´Ÿæ•°çš„æƒ…å†µ
  if (start < 0) {
    // å¦‚æœè´Ÿæ•°å–ååæ¯”æ•°ç»„çš„é•¿åº¦è¿˜è¦å¤§ï¼Œå³è¶…å‡ºäº†æ•°ç»„çš„èŒƒå›´ï¼Œåˆ™å–å€¼ä¸º0
    start = -start > length ? 0 : (length + start)
  }
  // endæœ€å¤§å–æ•°ç»„é•¿åº¦
  end = end > length ? length : end
  // end å°äº0
  if (end < 0) {
    end += length
  }
  // æ–°æ•°ç»„çš„é•¿åº¦
  length = start > end ? 0 : ((end - start) >>> 0)
  start >>>= 0

  let index = -1
  const result = new Array(length)
  // æˆªå–å¹¶è¿”å›æ–°æ•°ç»„
  while (++index < length) {
    result[index] = array[index + start]
  }
  return result
}
```
**start**  
> - å¦‚æœè¯¥å‚æ•°ä¸ºè´Ÿæ•°ï¼Œåˆ™è¡¨ç¤ºä»åŸæ•°ç»„ä¸­çš„å€’æ•°ç¬¬å‡ ä¸ªå…ƒç´ å¼€å§‹æå–ã€‚
> - å¦‚æœçœç•¥ï¼Œåˆ™ä»ç´¢å¼•0å¼€å§‹

**end**
> - å¦‚æœè¯¥å‚æ•°ä¸ºè´Ÿæ•°ï¼Œåˆ™å®ƒè¡¨ç¤ºåœ¨åŸæ•°ç»„ä¸­çš„å€’æ•°ç¬¬å‡ ä¸ªå…ƒç´ ç»“æŸåˆ¶å–ã€‚
> - å¦‚æœendè¢«çœç•¥ï¼Œåˆ™sliceä¼šä¸€ç›´æå–åˆ°åŸæ•°ç»„çš„æœ«å°¾ã€‚
> - å¦‚æœendå¤§äºæ•°ç»„é•¿åº¦ï¼Œsliceä¹Ÿä¼šä¸€ç›´æå–åˆ°åŸæ•°ç»„æœ«å°¾ã€‚

**å…³äº `start >>>= 0`**  
- ä½¿ç”¨ `>>>` æ¥ç¡®ä¿ `start` å‚æ•°ä¸ºæ•´æ•°æˆ–0ã€‚  
- å› ä¸º `lodash` çš„ `slice` é™¤äº†å¯ä»¥å¤„ç†æ•°ç»„å¤–ï¼Œä¹Ÿå¯ä»¥å¤„ç†ç±»æ•°ç»„( `arguments` å¯¹è±¡å’Œ `DOM` æ–¹æ³•çš„è¿”å›ç»“æœ)ï¼Œå› æ­¤ç¬¬ä¸€ä¸ªå‚æ•° `array` å¯èƒ½ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œ `length` å±æ€§ä¸ä¸€å®šä¸ºæ•°å­—ã€‚
- æ›´å¤šçŸ¥è¯†è¯·å‚è€ƒâ€œç§»ä½è¿ç®—ç¬¦â€